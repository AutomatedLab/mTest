.\build.ps1 -Tasks noop
$datum = New-DatumStructure -DefinitionFile .\source\Datum.yml

#will be unencrypted when accessing it
$datum.Global.Azure.Dev.AzWorkerServicePrincipalPfxPassword

#in the background this happens
#a pass phrase is required as a secure string
$pass = $datum.__Definition.DatumHandlers[0].CommandOptions.PlainTextPassword | ConvertTo-SecureString -AsPlainText -Force

$encString = '[ENC=PE9ianMgVmVyc2lvbj0iMS4xLjAuMSIgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vcG93ZXJzaGVsbC8yMDA0LzA0Ij4NCiAgPE9iaiBSZWZJZD0iMCI+DQogICAgPFROIFJlZklkPSIwIj4NCiAgICAgIDxUPlN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDdXN0b21PYmplY3Q8L1Q+DQogICAgICA8VD5TeXN0ZW0uT2JqZWN0PC9UPg0KICAgIDwvVE4+DQogICAgPE1TPg0KICAgICAgPE9iaiBOPSJLZXlEYXRhIiBSZWZJZD0iMSI+DQogICAgICAgIDxUTiBSZWZJZD0iMSI+DQogICAgICAgICAgPFQ+U3lzdGVtLk9iamVjdFtdPC9UPg0KICAgICAgICAgIDxUPlN5c3RlbS5BcnJheTwvVD4NCiAgICAgICAgICA8VD5TeXN0ZW0uT2JqZWN0PC9UPg0KICAgICAgICA8L1ROPg0KICAgICAgICA8TFNUPg0KICAgICAgICAgIDxPYmogUmVmSWQ9IjIiPg0KICAgICAgICAgICAgPFROUmVmIFJlZklkPSIwIiAvPg0KICAgICAgICAgICAgPE1TPg0KICAgICAgICAgICAgICA8UyBOPSJIYXNoIj4zQ0JEMjcwOUYwRkI5REIyOEZEQzg0RTkwQjY2N0M2Q0JGMUI5MzNEQjUyQTNCNUNEMzY3QzdGRTI2NjIwODE2PC9TPg0KICAgICAgICAgICAgICA8STMyIE49Ikl0ZXJhdGlvbkNvdW50Ij41MDAwMDwvSTMyPg0KICAgICAgICAgICAgICA8QkEgTj0iS2V5Ij5HOUNzSFBHVEVEKzRKZkc3M2IwS2R6VDM2ejFKcklDT2FxeU01K2FCYmo4SUVZVnNtdmNEOXFvdk92Nks4YWw0PC9CQT4NCiAgICAgICAgICAgICAgPEJBIE49Ikhhc2hTYWx0Ij5uRnh0S1NEVDB2MkpIZTh5cEpLL21aSExoR0p0UjI1NzJXQ2I3aVhqOFJBPTwvQkE+DQogICAgICAgICAgICAgIDxCQSBOPSJTYWx0Ij5LalI4QTVaR3FmM2F0ck5GZHJXb09mSktKUFdoSUxMcTZBRXBjN0locHdzPTwvQkE+DQogICAgICAgICAgICAgIDxCQSBOPSJJViI+TFJocGlMbnovMDFYYjIzWGhQRHhEU0JFanRtTlN2TW85ODFCSG45SmJ1WT08L0JBPg0KICAgICAgICAgICAgPC9NUz4NCiAgICAgICAgICA8L09iaj4NCiAgICAgICAgPC9MU1Q+DQogICAgICA8L09iaj4NCiAgICAgIDxCQSBOPSJDaXBoZXJUZXh0Ij5LVjc4UGU0VlVITjFFOTZQVzFBQmt3PT08L0JBPg0KICAgICAgPEJBIE49IkhNQUMiPmJFVU5SbHQ0YVoxajdCbzdNQ0JlQjBYNmRrcEJjTnpqQ2pEbVd0RXRRWjg9PC9CQT4NCiAgICAgIDxTIE49IlR5cGUiPlN5c3RlbS5TdHJpbmc8L1M+DQogICAgPC9NUz4NCiAgPC9PYmo+DQo8L09ianM+]'
$encString = $encString -replace '\[ENC=',''
$encString = $encString -replace '\]',''

$encString | Unprotect-Datum -Password $pass

#create a protected datum string
$value = 'Somepass1'
$value | Protect-Datum -Password $pass -MaxLineLength 9999 | clip
